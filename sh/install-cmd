#!/bin/sh
echo "ğŸš€ Downloading...";
git clone https://github.com/ApolloZhu/Srt2BilibiliKit.git
if [[ $? != 0 ]]; then 
    echo "âŒ Failed to download";
    exit 1;
fi
cd Srt2BilibiliKit

echo "ğŸ›   Building...";
swift package clean
if [[ $? != 0 ]]; then 
    echo "âŒ Failed to build";
    exit 1;
fi
swift build -c release
if [[ $? != 0 ]]; then 
    echo "âŒ Failed to build";
    exit 1;
fi

echo "ğŸ—‘  Clean up...";
cp .build/release/Srt2Bilibili-cli /usr/local/bin/s2bkit
if [[ $? != 0 ]]; then 
    cp .build/release/Srt2Bilibili-cli s2bkit
fi
cd ..
rm -rf Srt2BilibiliKit

echo "ğŸ“š s2bkit --help"
s2bkit
if [[ $? != 0 ]]; then 
    echo "âŒ Failed to execute";
    exit 1;
fi
echo "âœ… Done!"
